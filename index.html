<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cek Budget Fasus</title>

<style>

body{
margin:0;
font-family:Arial;
background:#000;
color:white;
background-image:url("background.jpg");
background-size:cover;
background-position:center;
}

.overlay{
background:rgba(0,0,0,0.65);
width:100%;
height:100vh;
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
}

.logo{
position:absolute;
top:30px;
}

.logo img{
height:70px;
}

.title{
font-size:48px;
font-weight:bold;
margin-bottom:30px;
text-align:center;
}

.searchBox{
display:flex;
gap:10px;
position:relative;
}

input{
width:400px;
padding:15px;
font-size:18px;
border-radius:8px;
border:none;
outline:none;
}

button{
padding:15px 25px;
font-size:18px;
background:#FFD100;
border:none;
border-radius:8px;
cursor:pointer;
font-weight:bold;
}

button:hover{
background:#ffcc00;
}

.suggest{
position:absolute;
top:60px;
background:white;
color:black;
width:400px;
border-radius:8px;
overflow:hidden;
z-index:999;
max-height:250px;
overflow-y:auto;
box-shadow:0 5px 15px rgba(0,0,0,0.4);
}

.suggest div{
padding:12px;
cursor:pointer;
}

.suggest div:hover{
background:#eee;
}

.loading{
margin-top:10px;
font-size:14px;
color:#FFD100;
}

</style>

</head>

<body>

<div class="overlay">

<div class="logo">
<img src="logo-ut-school.png">
</div>

<div class="title">
CEK BUDGET FASUS
</div>

<div class="searchBox">

<div>

<input id="input"
placeholder="Ketik nama perusahaan..."
autocomplete="off">

<div id="suggest" class="suggest"></div>

<div id="loading" class="loading">
Loading data...
</div>

</div>

<button onclick="checkFasus()">
Check
</button>

</div>

</div>

<script>

const sheetURL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vTbJYRkPPTPDYHrDTy-eA_e5rUZ_VowdvBDjHU0BD7rKTvHIZfZAQf_ctl8qDkpiGYVnr9qARdX4fZ6/pub?output=csv";

let fasusList = [];

function cleanText(text){

return text
.replace(/^"/,"")
.replace(/"$/,"")
.replace(/\r/g,"")
.replace(/\n/g,"")
.replace(/\t/g,"")
.trim();

}

function parseCSVLine(line){

const result = [];
let current = "";
let insideQuotes = false;

for(let i=0;i<line.length;i++){

const char = line[i];

if(char === '"'){
insideQuotes = !insideQuotes;
}
else if(char === "," && !insideQuotes){
result.push(current);
current="";
}
else{
current+=char;
}

}

result.push(current);

return result;

}

fetch(sheetURL)
.then(res=>res.text())
.then(text=>{

const rows = text.split("\n");

for(let i=1;i<rows.length;i++){

const cols = parseCSVLine(rows[i]);

if(cols.length > 0){

const name = cleanText(cols[0]);

if(name !== "" && !fasusList.includes(name)){
fasusList.push(name);
}

}

}

fasusList.sort();

console.log("Loaded fasus:", fasusList);

document.getElementById("loading").style.display="none";

})
.catch(err=>{

console.error("Spreadsheet load error:", err);

document.getElementById("loading").innerText =
"Gagal load data";

});

const input =
document.getElementById("input");

const suggest =
document.getElementById("suggest");

input.addEventListener("input", function(){

const value =
this.value.toLowerCase();

suggest.innerHTML="";

if(value==="") return;

const filtered =
fasusList.filter(f =>
f.toLowerCase().includes(value)
);

filtered.slice(0,8).forEach(f=>{

const div =
document.createElement("div");

div.innerText=f;

div.onclick=function(){

input.value=f;

suggest.innerHTML="";

};

suggest.appendChild(div);

});

});

function checkFasus(){

const fasus =
input.value.trim();

if(fasus===""){
alert("Masukkan nama perusahaan");
return;
}

if(!fasusList.includes(fasus)){
alert("Perusahaan tidak ditemukan");
return;
}

window.location.href =
"fasus.html?fasus=" +
encodeURIComponent(fasus);

}

document.addEventListener("click", function(e){

if(!e.target.closest(".searchBox")){
suggest.innerHTML="";
}

});

</script>

</body>
</html>
